<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GEINFOV3 ‚Äî In√≠cio</title>
  <meta name="description" content="Painel GEINFOV3 ‚Äî avisos, materiais, videoaulas, biografias e mais." />

  <style>
    :root{
      --verde-bebe: #c8f7dc;
      --salm√£o-claro: #ffddd2;
      --branco: #ffffff;
      --rosa-menu: #ffc2b3;
      --texto: #163826;
      --accent: #f47966;
      --card-shadow: 0 6px 18px rgba(17,24,39,0.06);
      --glass: rgba(255,255,255,0.75);
    }

    /* Reset simples */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: "Inter", "Segoe UI", Roboto, Arial, sans-serif;
      background: linear-gradient(120deg,var(--verde-bebe) 0%, var(--salm√£o-claro) 100%);
      color:var(--texto);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      min-height:100vh;
    }

    /* SIDEBAR */
    .sidebar{
      width:260px;
      background:linear-gradient(180deg,var(--rosa-menu), #ffdfd6);
      padding:22px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      gap:12px;
      box-shadow: 4px 0 24px rgba(0,0,0,0.06);
      position:fixed;
      inset:0 auto 0 0;
      z-index:10;
    }
    .brand{
      text-align:center;
      font-weight:800;
      color:var(--texto);
      letter-spacing:0.6px;
      margin-bottom:6px;
    }
    .menu{display:flex;flex-direction:column;gap:8px;margin-top:8px}
    .menu a{
      display:flex;align-items:center;gap:10px;
      padding:10px 12px;border-radius:10px;
      background:var(--branco); color:var(--texto);
      text-decoration:none;font-weight:600;
      box-shadow: var(--card-shadow);
      transition:transform .16s ease, box-shadow .16s ease;
    }
    .menu a:hover{ transform:translateX(6px); box-shadow: 0 10px 24px rgba(0,0,0,0.08); }

    .sidebar .bottom{
      margin-top:auto;
      text-align:center;
    }
    .logout-btn{
      background:#fff;padding:10px 14px;border-radius:10px;color:#b33;
      text-decoration:none;font-weight:700;display:inline-block;
      box-shadow: var(--card-shadow);
    }

    /* MAIN */
    .main{
      margin-left:260px;
      padding:28px;
      flex:1;
      display:flex;
      flex-direction:column;
      gap:18px;
    }

    header.top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:14px;
    }

    .title{
      font-size:34px;
      font-weight:900;
      color:var(--accent);
      letter-spacing:1px;
      text-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    /* profile + notifications */
    .rightbar{
      display:flex;gap:12px;align-items:center;
    }

    .notif{
      position:relative;
      font-size:22px;
      cursor:pointer;
      padding:8px;border-radius:8px;background:var(--glass);
      box-shadow: var(--card-shadow);
    }
    .notif .badge{
      position:absolute;top:4px;right:4px;background:#ff5f5f;color:#fff;
      font-size:12px;padding:2px 6px;border-radius:999px;font-weight:700;
    }

    .notif-dropdown{
      display:none;
      position:absolute;
      right:0;
      top:46px;
      width:300px;
      background:#fff;border-radius:10px;padding:10px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
      z-index:30;
    }
    .notif-dropdown h4{font-size:14px;margin-bottom:8px;color:#333}
    .notif-dropdown ul{list-style:none;padding-left:14px}
    .notif-dropdown li{font-size:13px;padding:6px 4px;border-bottom:1px solid #f4f4f4}
    .notif-dropdown li:last-child{border-bottom:0}

    .profile-card{
      display:flex;align-items:center;gap:10px;padding:8px 12px;border-radius:12px;
      background:var(--glass);box-shadow:var(--card-shadow);
    }
    .profile-card img{
      width:52px;height:52px;border-radius:50%;object-fit:cover;border:2px solid var(--branco);
      cursor:pointer;
    }
    .profile-card .name{font-weight:700;font-size:14px}

    /* SEARCH */
    .search{
      display:flex;gap:8px;align-items:center;
    }
    .search input{
      padding:12px 14px;border-radius:999px;border:none;box-shadow:var(--card-shadow);
      width:360px;max-width:70vw;background:#fff;font-size:14px;
    }

    /* CARDS GRID */
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:18px;
      margin-top:6px;
    }
    .card{
      background:rgba(255,255,255,0.98);
      padding:18px;border-radius:12px;box-shadow:var(--card-shadow);
      transition:transform .14s ease, box-shadow .14s ease;
      text-decoration:none;color:var(--texto);display:block;
    }
    .card:hover{transform:translateY(-6px);box-shadow:0 14px 30px rgba(0,0,0,0.08)}
    .card h3{margin-bottom:6px}
    .card p{font-size:13px;color:#666}

    /* RECENT MATERIALS */
    .materials{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:8px}
    .material{
      padding:12px;background:rgba(255,255,255,0.95);border-radius:10px;box-shadow:var(--card-shadow)
    }
    .section-title{font-size:18px;font-weight:800;margin-top:6px;color:#2b5}

    /* FOOTER small */
    footer.small{margin-top:auto;padding-top:12px;font-size:13px;color:#444;opacity:0.8}

    /* RESPONSIVE */
    @media (max-width:900px){
      .title{font-size:28px}
      .search input{width:220px}
    }
    @media (max-width:700px){
      .sidebar{display:none}
      .main{margin-left:0;padding:18px}
      .search input{width:100%}
      .notif-dropdown{right:-10px;width:260px}
    }
  </style>
</head>
<body>

  <!-- SIDEBAR -->
  <aside class="sidebar" role="navigation" aria-label="Menu principal">
    <div>
      <div class="brand">GEINFO V3</div>
      <nav class="menu" aria-label="Se√ß√µes">
        <a href="avisos.html">üì¢ Avisos</a>
        <a href="aulas.html">üìö Materiais</a>
        <a href="aulasfu.html">üìù Materiais Futuros</a>
        <a href="videoAula.html">üé• Videoaulas</a>
        <a href="comentarios.html">üó≥Ô∏è Coment√°rios</a>
        <a href="perfil.html">üë§ Biografias</a>
        <a href="campus.html">üö® Campus</a>
        <a href="professores.html">üë®‚Äçüè´ Professores</a>
      </nav>
    </div>

    <div class="bottom">
      <div style="text-align:center; margin-bottom:8px;">
        <small style="color:#444;font-weight:700">Entrou como</small><br>
        <span id="sideUserName" style="font-weight:800"></span>
      </div>
      <div style="text-align:center;">
        <a class="logout-btn" href="login.html" id="logoutBtn">Sair</a>
      </div>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">
    <!-- HEADER -->
    <header class="top" role="banner">
      <div>
        <div class="title" aria-hidden="true">GEINFOV3</div>
        <div style="color:#444;margin-top:6px;font-size:13px">Grupo de Estudos  INFO ‚Äî 3¬∫ ano vespertino</div>
      </div>

      <div class="rightbar" role="region" aria-label="A√ß√µes r√°pidas">
        <div class="search" role="search" aria-label="Buscar">
          <input id="searchInput" placeholder="Buscar: avisos, biografias, materiais..." />
        </div>

        <div class="notif" id="notifBtn" aria-haspopup="true" aria-expanded="false" title="Notifica√ß√µes">
          üîî <span class="badge" id="notifCount" style="display:none">0</span>

          <div class="notif-dropdown" id="notifDropdown" aria-hidden="true">
            <h4>√öltimos avisos</h4>
            <ul id="recentAvisos">
              <li>Carregando...</li>
            </ul>
          </div>
        </div>

        <div class="profile-card" title="Seu perfil">
          <a id="profileLink" href="#" aria-label="Ver perfil">
            <img id="profilePic" src="" alt="Foto do usu√°rio" />
          </a>
          <div>
            <div class="name" id="studentName">Usu√°rio</div>
            <div style="font-size:12px;color:#666">Aluno</div>
          </div>
        </div>
      </div>
    </header>
    

    <!-- CARDS PRINCIPAIS -->
    <section aria-label="Principais a√ß√µes">
      <div class="grid" id="mainCards">
        <a class="card" href="avisos.html"><h3>üì¢ Avisos</h3><p>Veja comunicados e mudan√ßas de sala/professores.</p></a>
        <a class="card" href="aulasmi.html"><h3>üìö Materiais Ministrados</h3><p>Slides, listas e arquivos das aulas j√° dadas.</p></a>
        <a class="card" href="aulasfu.html"><h3>üìù Materiais Futuros</h3><p>T√≥picos programados para as pr√≥ximas aulas.</p></a>
        <a class="card" href="videoAula.html"><h3>üé• Videoaulas</h3><p>Links e playlists recomendadas por alunos e professores.</p></a>
        <a class="card" href="comentarios.html"><h3>üí¨ Coment√°rios</h3><p>Feedbacks e discuss√µes entre alunos.</p></a>
        <a class="card" href="perfil.html"><h3>üë• Biografias</h3><p>Perfis da turma ‚Äî clique para ver detalhes.</p></a>
        <a class="card" href="campus.html"><h3>üìç Campus</h3><p>Avisos e contato do campus IFPAR.</p></a>
        <a class="card" href="professores.html"><h3>üë©‚Äçüè´ Professores</h3><p>Lista de professores e contatos.</p></a>
      </div>
    </section>

    <!-- MATERIAIS RECENTES -->
    <section aria-label="Materiais recentes">
      <div class="section-title">Materiais Recentes</div>
      <div class="materials" id="recentMaterials">
        <div class="material"><strong>Trigonometria</strong><div style="font-size:13px;color:#666">Slide e lista de exerc√≠cios</div></div>
        <div class="material"><strong>HTML/CSS</strong><div style="font-size:13px;color:#666">Slide + arquivos pr√°ticos</div></div>
        <div class="material"><strong>Redes de Computadores</strong><div style="font-size:13px;color:#666">Topologias ‚Äî em breve</div></div>
      </div>
    </section>

    <footer class="small" aria-hidden="true">
      GEINFOV3 ‚Ä¢ Mantido pela turma ‚Äî design atualizado
    </footer>
  </main>

  <!-- SCRIPTS -->
  <script>
    // Fun√ß√µes utilit√°rias
    function normalizeName(name){
      // remove acentos e caracteres especiais, transforma em lower_case com underline
      if(!name || typeof name !== 'string') return '';
      return name.normalize('NFD').replace(/[\u0300-\u036f]/g,'')
                 .replace(/[^\w\s-]/g,'') // remove outros s√≠mbolos
                 .trim()
                 .replace(/\s+/g,'_')
                 .toLowerCase();
    }
  
    document.addEventListener('DOMContentLoaded', () => {
      // 1) Carregar usu√°rio (prioridade: localStorage > URL param)
      let usuario = null;
      try {
        const stored = localStorage.getItem('usuarioLogado');
        if(stored) usuario = JSON.parse(stored);
      } catch(e){ console.warn('localStorage parse error', e); }
  
      const urlName = new URLSearchParams(window.location.search).get('nome');
      if(!usuario && urlName){
        usuario = { nome: urlName };
      }
  
      const nameEl = document.getElementById('studentName');
      const sideNameEl = document.getElementById('sideUserName');
      const profilePic = document.getElementById('profilePic');
      const profileLink = document.getElementById('profileLink');
  
      const displayName = (usuario && usuario.nome) ? usuario.nome : 'Usu√°rio';
      nameEl.textContent = displayName;
      if(sideNameEl) sideNameEl.textContent = displayName;
  
      // Define o link para a p√°gina de perfil com par√¢metro nome
      profileLink.href = `perfilUser.html?nome=${encodeURIComponent(displayName)}`;
  
      // 2) Imagem de perfil - procura arquivo por nome normalizado; fallback para default
      (function setProfileImage(){
        const base = 'fotosPerfis/alunos/';
  
        if (!profilePic) {
          console.warn('Elemento #profilePic n√£o encontrado no DOM');
          return;
        }
  
        // caso usuario venha com um campo 'foto' j√° definido
        if (usuario && usuario.foto) {
          profilePic.src = usuario.foto;
          profilePic.onerror = () => profilePic.src = base + 'default.jpg';
          return;
        }
  
        // regra especial (Ketlyn)
        if (displayName.toLowerCase().includes('ketlyn')) {
          profilePic.src = base + 'ketlyn.jpg';
          profilePic.onerror = () => profilePic.src = base + 'default.jpg';
          return;
        }
  
        const candidate = base + normalizeName(displayName) + '.jpg';
        profilePic.src = candidate;
  
        // Garante que se a imagem n√£o existir, carrega uma padr√£o
        profilePic.onerror = () => {
          console.warn(`Imagem n√£o encontrada: ${candidate}, usando default.jpg`);
          profilePic.src = base + 'default.jpg';
        };
      })();
  
      // 3) Notifica√ß√µes: abrir/fechar dropdown e carregar avisos.json (2 itens)
      const notifBtn = document.getElementById('notifBtn');
      const notifDropdown = document.getElementById('notifDropdown');
      const recentAvisosUl = document.getElementById('recentAvisos');
      const notifCount = document.getElementById('notifCount');
  
      function closeNotif(){
        notifDropdown.style.display = 'none';
        notifBtn.setAttribute('aria-expanded','false');
        notifDropdown.setAttribute('aria-hidden','true');
      }
      function openNotif(){
        notifDropdown.style.display = 'block';
        notifBtn.setAttribute('aria-expanded','true');
        notifDropdown.setAttribute('aria-hidden','false');
      }
  
      notifBtn.addEventListener('click', e=> {
        e.stopPropagation();
        if(notifDropdown.style.display === 'block') closeNotif();
        else openNotif();
      });
      document.addEventListener('click', ()=> closeNotif());
  
      // fetch avisos.json (tente na mesma pasta). se falhar, usar fallback est√°tico
      (function loadAvisos(){
        const fallback = [
          { titulo: 'Aula de Hist√≥ria remarcada ‚Äî Lab 2', data:'2025-06-13' },
          { titulo: 'Material de Qu√≠mica dispon√≠vel', data:'2025-06-12' }
        ];
  
        fetch('avisos.json')
          .then(r => {
            if(!r.ok) throw new Error('no file');
            return r.json();
          })
          .then(list => {
            const avisos = Array.isArray(list) ? list : fallback;
            renderAvisos(avisos.slice(0,2));
          })
          .catch(() => renderAvisos(fallback));
      })();
  
      function renderAvisos(list){
        recentAvisosUl.innerHTML = '';
        list.forEach(a=>{
          const li = document.createElement('li');
          li.textContent = (a.titulo || 'Aviso');
          recentAvisosUl.appendChild(li);
        });
        if(list.length > 0){
          notifCount.style.display = 'inline-block';
          notifCount.textContent = list.length;
        } else {
          notifCount.style.display = 'none';
        }
      }
  
      // 4) Search: redireciona dependendo do texto (simples)
      const searchInput = document.getElementById('searchInput');
      if(searchInput){
        searchInput.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter'){
            const q = (searchInput.value || '').toLowerCase();
            if(q.includes('aviso')) window.location.href = 'avisos.html';
            else if(q.includes('bio') || q.includes('biografia')) window.location.href = 'perfil.html';
            else if(q.includes('coment')) window.location.href = 'comentarios.html';
            else if(q.includes('campus')) window.location.href = 'campus.html';
            else window.alert('Termo n√£o reconhecido ‚Äî tente "avisos", "biografias", "coment√°rios" ou "campus".');
          }
        });
      }
  
      // 5) Logout: remove localStorage e redireciona
      const logout = document.getElementById('logoutBtn');
      if(logout){
        logout.addEventListener('click', (e)=>{
          // permite que o link atue normalmente, mas limpamos a sess√£o antes
          localStorage.removeItem('usuarioLogado');
        });
      }
  
      // (Opcional) - se quiser pr√©-carregar materiais din√¢micos, aqui √© o lugar.
    }); // DOMContentLoaded
  </script>
  
</body>
</html>
